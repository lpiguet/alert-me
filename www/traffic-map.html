<div id="map_canvas" style="margin-top:5px;"></div>

<script type="text/javascript">

  var latlongpos = new google.maps.LatLng(46.51848, 6.51129);

  var win = function(position) {
    var lat = position.coords.latitude;
    var long = position.coords.longitude;
    latlongpos = new google.maps.LatLng(lat, long);
  };

  var fail = function(e) {
    alert('Can\'t retrieve position.\nError: ' + e);
  };

  watchID = navigator.geolocation.getCurrentPosition(win, fail);

  $('#map_canvas').height($(window).height()-170);
    var mapOptions = {
      center: latlongpos,
      zoom: 11,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

    var trafficLayer = new google.maps.TrafficLayer();
    trafficLayer.setMap(map);
</script>
